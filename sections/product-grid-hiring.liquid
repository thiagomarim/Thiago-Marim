{% comment %} 
    Product Grid Hiring Section
    Displays a product grid with plus icon and modal for product details
    Get variant selectors for color and size options from the product
    Supports call-to-action button
    Supports backdrop click to close
    Supports close button
    Supports mobile and desktop views 
{% endcomment %}

{{ 'product-grid-hiring.css' | asset_url | stylesheet_tag }}
<script src="{{ 'product-grid-hiring.js' | asset_url }}" defer="defer"></script>

{%- liquid
  assign sec = section.settings
  assign blocks = section.blocks
-%}

<!-- Container: Product Grid Hiring -->
<div class="product-grid-hiring__container">
  {% if sec.title  != blank %}
    <h2>{{ sec.title }}</h2>
  {% endif %}

  <!-- Grid of products -->
  <div class="product-grid-hiring__grid">
    {% for block in blocks %}
      {% if block.settings.product != blank %}
        <div
          class="product-grid-hiring__grid-item"
          style="--pos-x: {{ block.settings.icon-position-x | default: 0 }}; --pos-y: {{ block.settings.icon-position-y | default: 0 }};"
          data-title="{{ block.settings.product.title | escape }}"
          data-price="{{ block.settings.product.price | money_with_currency }}"
          data-description="{{ block.settings.product.description | strip_html | escape }}"
          data-image="{{ block.settings.product.featured_image | image_url }}"
          data-handle="{{ block.settings.product.handle }}">
            <!-- Product image -->
          <img
            src="{{ block.settings.product.featured_image | image_url }}"
            alt="{{ block.settings.product.featured_image.alt }}"
            width="100%"
            height="100%">

          <!-- Floating plus icon trigger -->
          <div class="product-grid-hiring__grid-plus-icon">
            {{ 'plus.svg' | inline_asset_content }}
          </div>
        </div>
      {% endif %}
    {% endfor %}
  </div>
</div>

<!-- Modal: Product details and variant selection -->
<div class="product-grid-hiring__modal">
  <!-- Backdrop (click to close) -->
  <div class="product-grid-hiring__modal-backdrop" data-close></div>

  <!-- Modal content wrapper -->
  <div class="product-grid-hiring__modal-content">
    <button
      class="product-grid-hiring__modal-close"
      type="button"
      aria-label="Close"
      data-close>Ã—</button>
    <div class="product-grid-hiring__modal-content__info">
      <!-- Media preview -->
      <div class="product-grid-hiring__modal-content__info__media">
        <img
          alt=""
          width="100%"
          height="100%" />
      </div>

      <!-- Text information -->
      <div class="product-grid-hiring__modal-content__info__text">
        <h3 id="modal-title"></h3>
        <span id="modal-price"></span>
        <p id="modal-description"></p>
      </div>

    </div>

    <!-- Variant selectors -->
    <div class="product-grid-hiring__modal-content__variants">
      <div class="product-grid-hiring__modal-content__variants__color">
        <h3>Color</h3>
        <div class="variant-color-options" data-variant-colors></div>
      </div>
      <div class="product-grid-hiring__modal-content__variants__size">
        <h3>Size</h3>
        <div class="variant-size-select" data-variant-sizes>
          <div class="variant-size-select__trigger">
            <span class="variant-size-select__text">Choose your size</span>
            <div class="variant-size-select__arrow">
              {{ 'arrow-down.svg' | inline_asset_content }}
            </div>
          </div>
          <ul class="variant-size-select__dropdown" style="display: none;">
            <!-- Options will be populated by JavaScript -->
          </ul>
        </div>
      </div>
    </div>

    <!-- Call to action: Add to Cart -->
    <a href="{{ sec.button_link }}" class="product-grid-hiring__modal-content__actions__button">
      <div class="product-grid-hiring__modal-content__actions__button_content">
        <span>Add to Cart</span>
        <span class="product-grid-hiring__modal-content__actions__button_icon" aria-hidden="true">
          {{ 'arrow-right.svg' | inline_asset_content }}
        </span>
      </div>
    </a>
  </div>
</div>

{% schema %}
  {
    "name": "Product Grid Hiring",
    "tag": "section",
    "settings": [
      {
        "type": "text",
        "id": "title",
        "label": "Title",
        "default": "Tisso vison in the wild"
      }
    ],
    "blocks": [
      {
        "type": "product",
        "name": "Product",
        "settings": [
          {
            "type": "header",
            "content": "Product Settings"
          },
          {
            "type": "product",
            "id": "product",
            "label": "Product",
            "info": "Select the product to display in the grid"
          },
          {
            "type": "header",
            "content": "Icon Settings"
          },
          {
            "type": "range",
            "id": "icon-position-x",
            "label": "Icon Position X",
            "default": 60,
            "min": 0,
            "max": 100,
            "step": 1,
            "info": "0 = Left, 100 = Right"
          }, {
            "type": "range",
            "id": "icon-position-y",
            "label": "Icon Position Y",
            "default": 60,
            "min": 0,
            "max": 100,
            "step": 1,
            "info": "0 = Top, 100 = Bottom"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Product Grid Hiring",
        "settings": {}
      }
    ]
  }
{% endschema %}